{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import\"./main.css\";import\"./processing.css\";import{Link,useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Processing(){const navigate=useNavigate();const[status,setStatus]=useState({});const[videoUrl,setVideoUrl]=useState(null);const statusIcons={completed:\"\".concat(process.env.PUBLIC_URL,\"/fyp-images/tick.png\"),processing:\"\".concat(process.env.PUBLIC_URL,\"/fyp-images/inprogress.png\"),pending:\"\".concat(process.env.PUBLIC_URL,\"/fyp-images/pending.jpeg\")};const stepNames={objectDetection:\"Object Detection\",emotionAnalysis:\"Facial Expression Analysis\",musicRecommendation:\"Music Recommendation\",storyGeneration:\"Story Generation\"};useEffect(()=>{const storedUrl=localStorage.getItem(\"uploaded_video_url\");if(storedUrl)setVideoUrl(storedUrl);const interval=setInterval(async()=>{try{const res=await fetch(\"http://127.0.0.1:5000/status\");const data=await res.json();// Flask may return {objectDetection:..., emotionAnalysis:...} OR {status:{...}, result:{...}}\nconst currentStatus=data.status||data;setStatus(currentStatus);const allDone=Object.values(currentStatus).every(v=>v===\"completed\");if(allDone&&data.result){localStorage.setItem(\"detected_objects\",JSON.stringify(data.result.detected_objects||[]));localStorage.setItem(\"dominant_emotion\",data.result.dominant_emotion||\"neutral\");localStorage.setItem(\"recommended_song\",JSON.stringify(data.result.recommended_song||{}));localStorage.setItem(\"generated_story\",data.result.generated_story||\"\");navigate(\"/result\");}}catch(err){console.error(\"Error fetching status:\",err);}},1000);return()=>clearInterval(interval);},[navigate]);const progress=Object.values(status).filter(s=>s===\"completed\").length/4*100;const keyword=localStorage.getItem(\"selectedKeyword\")||\"—\";return/*#__PURE__*/_jsxs(\"div\",{className:\"keyword-page\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"top-heading\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(process.env.PUBLIC_URL,\"/fyp-images/iconmusic.webp\"),width:\"50\",height:\"55\",alt:\"MoodMelody Logo\"}),\" \",\"MoodMelody\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"top-Description\",children:\"AI Processing in Progress\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"uploads-flex\",children:[videoUrl?/*#__PURE__*/_jsx(\"video\",{src:videoUrl,className:\"video-preview\",controls:true,autoPlay:true,muted:true,loop:true,width:\"380\",height:\"270\"}):/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(process.env.PUBLIC_URL,\"/fyp-images/vedio.jpg\"),alt:\"Video Placeholder\",className:\"vedio-icon\"}),/*#__PURE__*/_jsxs(\"h3\",{className:\"keyword-heading\",children:[\"Keyword = \\u201C\",keyword,\"\\u201D\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-fill\",style:{width:\"\".concat(progress,\"%\")}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"processing-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"step-list\",children:Object.keys(stepNames).map(step=>/*#__PURE__*/_jsxs(\"div\",{className:\"step\",children:[/*#__PURE__*/_jsx(\"img\",{src:statusIcons[status[step]||\"pending\"],alt:status[step]||\"pending\",className:\"step-icon\"}),/*#__PURE__*/_jsx(\"p\",{children:stepNames[step]})]},step))}),/*#__PURE__*/_jsx(\"div\",{className:\"status-section\",children:Object.keys(stepNames).map(step=>/*#__PURE__*/_jsx(\"p\",{children:status[step]===\"completed\"?\"✅ Completed\":status[step]===\"processing\"?\"⏳ Processing...\":\"🕓 Pending\"},step))})]}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-btn\",onClick:()=>navigate(\"/keyword\"),children:\"Cancel Processing\"}),/*#__PURE__*/_jsx(\"nav\",{\"aria-label\":\"Page navigation\",className:\"page-nav\",children:/*#__PURE__*/_jsxs(\"ul\",{className:\"pagination-nav\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"page-item\",children:/*#__PURE__*/_jsx(Link,{to:\"/keyword\",className:\"page-link\",children:/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(process.env.PUBLIC_URL,\"/fyp-images/previous.png\"),width:\"40\",height:\"45\",alt:\"Previous\",className:\"previous\"})})}),/*#__PURE__*/_jsx(\"li\",{className:\"page-item next-link\",children:/*#__PURE__*/_jsx(Link,{to:\"/result\",className:\"page-link\",children:/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(process.env.PUBLIC_URL,\"/fyp-images/next.png\"),width:\"40\",height:\"45\",alt:\"Next\",className:\"next\"})})})]})})]});}","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","jsx","_jsx","jsxs","_jsxs","Processing","navigate","status","setStatus","videoUrl","setVideoUrl","statusIcons","completed","concat","process","env","PUBLIC_URL","processing","pending","stepNames","objectDetection","emotionAnalysis","musicRecommendation","storyGeneration","storedUrl","localStorage","getItem","interval","setInterval","res","fetch","data","json","currentStatus","allDone","Object","values","every","v","result","setItem","JSON","stringify","detected_objects","dominant_emotion","recommended_song","generated_story","err","console","error","clearInterval","progress","filter","s","length","keyword","className","children","src","width","height","alt","controls","autoPlay","muted","loop","style","keys","map","step","onClick","to"],"sources":["C:/Users/DELL/Desktop/MoodMelody/fyp-frontend/src/components/Processing.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport \"./main.css\";\r\nimport \"./processing.css\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\n\r\nexport default function Processing() {\r\n  const navigate = useNavigate();\r\n  const [status, setStatus] = useState({});\r\n  const [videoUrl, setVideoUrl] = useState(null);\r\n\r\n  const statusIcons = {\r\n    completed: `${process.env.PUBLIC_URL}/fyp-images/tick.png`,\r\n    processing: `${process.env.PUBLIC_URL}/fyp-images/inprogress.png`,\r\n    pending: `${process.env.PUBLIC_URL}/fyp-images/pending.jpeg`,\r\n  };\r\n\r\n  const stepNames = {\r\n    objectDetection: \"Object Detection\",\r\n    emotionAnalysis: \"Facial Expression Analysis\",\r\n    musicRecommendation: \"Music Recommendation\",\r\n    storyGeneration: \"Story Generation\",\r\n  };\r\n\r\n  useEffect(() => {\r\n    const storedUrl = localStorage.getItem(\"uploaded_video_url\");\r\n    if (storedUrl) setVideoUrl(storedUrl);\r\n\r\n    const interval = setInterval(async () => {\r\n      try {\r\n        const res = await fetch(\"http://127.0.0.1:5000/status\");\r\n        const data = await res.json();\r\n\r\n        // Flask may return {objectDetection:..., emotionAnalysis:...} OR {status:{...}, result:{...}}\r\n        const currentStatus = data.status || data;\r\n        setStatus(currentStatus);\r\n\r\n        const allDone = Object.values(currentStatus).every((v) => v === \"completed\");\r\n\r\n        if (allDone && data.result) {\r\n          localStorage.setItem(\r\n            \"detected_objects\",\r\n            JSON.stringify(data.result.detected_objects || [])\r\n          );\r\n          localStorage.setItem(\"dominant_emotion\", data.result.dominant_emotion || \"neutral\");\r\n          localStorage.setItem(\r\n            \"recommended_song\",\r\n            JSON.stringify(data.result.recommended_song || {})\r\n          );\r\n          localStorage.setItem(\"generated_story\", data.result.generated_story || \"\");\r\n          navigate(\"/result\");\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Error fetching status:\", err);\r\n      }\r\n    }, 1000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [navigate]);\r\n\r\n  const progress =\r\n    (Object.values(status).filter((s) => s === \"completed\").length / 4) * 100;\r\n\r\n  const keyword = localStorage.getItem(\"selectedKeyword\") || \"—\";\r\n\r\n  return (\r\n    <div className=\"keyword-page\">\r\n      {/* 🌟 Header */}\r\n      <h1 className=\"top-heading\">\r\n        <img\r\n          src={`${process.env.PUBLIC_URL}/fyp-images/iconmusic.webp`}\r\n          width=\"50\"\r\n          height=\"55\"\r\n          alt=\"MoodMelody Logo\"\r\n        />{\" \"}\r\n        MoodMelody\r\n      </h1>\r\n\r\n      <p className=\"top-Description\">AI Processing in Progress</p>\r\n\r\n      {/* 🎥 Video or Placeholder */}\r\n      <div className=\"uploads-flex\">\r\n        {videoUrl ? (\r\n          <video\r\n            src={videoUrl}\r\n            className=\"video-preview\"\r\n            controls\r\n            autoPlay\r\n            muted\r\n            loop\r\n            width=\"380\"\r\n            height=\"270\"\r\n          />\r\n        ) : (\r\n          <img\r\n            src={`${process.env.PUBLIC_URL}/fyp-images/vedio.jpg`}\r\n            alt=\"Video Placeholder\"\r\n            className=\"vedio-icon\"\r\n          />\r\n        )}\r\n        <h3 className=\"keyword-heading\">Keyword = “{keyword}”</h3>\r\n      </div>\r\n\r\n      {/* 📊 Progress Bar */}\r\n      <div className=\"progress-bar\">\r\n        <div className=\"progress-fill\" style={{ width: `${progress}%` }}></div>\r\n      </div>\r\n\r\n      <div className=\"processing-content\">\r\n  <div className=\"step-list\">\r\n    {Object.keys(stepNames).map((step) => (\r\n      <div className=\"step\" key={step}>\r\n        <img\r\n          src={statusIcons[status[step] || \"pending\"]}\r\n          alt={status[step] || \"pending\"}\r\n          className=\"step-icon\"\r\n        />\r\n        <p>{stepNames[step]}</p>\r\n      </div>\r\n    ))}\r\n  </div>\r\n\r\n  <div className=\"status-section\">\r\n    {Object.keys(stepNames).map((step) => (\r\n      <p key={step}>\r\n        {status[step] === \"completed\"\r\n          ? \"✅ Completed\"\r\n          : status[step] === \"processing\"\r\n          ? \"⏳ Processing...\"\r\n          : \"🕓 Pending\"}\r\n      </p>\r\n    ))}\r\n  </div>\r\n</div>\r\n\r\n\r\n      {/* 🔘 Buttons */}\r\n      <button className=\"cancel-btn\" onClick={() => navigate(\"/keyword\")}>\r\n        Cancel Processing\r\n      </button>\r\n\r\n      <nav aria-label=\"Page navigation\" className=\"page-nav\">\r\n        <ul className=\"pagination-nav\">\r\n          <li className=\"page-item\">\r\n            <Link to=\"/keyword\" className=\"page-link\">\r\n              <img\r\n                src={`${process.env.PUBLIC_URL}/fyp-images/previous.png`}\r\n                width=\"40\"\r\n                height=\"45\"\r\n                alt=\"Previous\"\r\n                className=\"previous\"\r\n              />\r\n            </Link>\r\n          </li>\r\n          <li className=\"page-item next-link\">\r\n            <Link to=\"/result\" className=\"page-link\">\r\n              <img\r\n                src={`${process.env.PUBLIC_URL}/fyp-images/next.png`}\r\n                width=\"40\"\r\n                height=\"45\"\r\n                alt=\"Next\"\r\n                className=\"next\"\r\n              />\r\n            </Link>\r\n          </li>\r\n        </ul>\r\n      </nav>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}